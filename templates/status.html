{% extends "layout.html" %}
{% block title %}Southwest Checkin - Status{% endblock %}
{% block body %}
  <div class="text-centered">
    <div id="status">
      <h1 class="text-centered logo"><a href="/">Southwest Check In</a></h1>
      <div>
        <div>
          <h2 class="text-centered">
            {% if res.active %}
              Your first automatic checkins are at: 
              <span class="highlight">
                <ul>
                  {% for flight in flights %}
                    {% if flight.sched_time_local_formatted %}
                      <li>{{ flight.sched_time_local_formatted }}</li>
                    {% endif %}
                  {% endfor %}
                </ul>
              </span>
            {% else %}
              <span class="highlight">All your flights have left!</span>
            {% endif %}
          </h2>
        </div>
        <div><h3 class="text-centered">Confirmation Code: {{ res.code }}</h3></div>
        <div><h3 class="text-centered">Passenger Name: {{ res.first_name }} {{ res.last_name }}</h3></div>
        <ul class="flights">
          {% for flight in flights %}
            <li>Flight {{ loop.index }}:
              <ul class="flight-legs">
                {% for leg in flight.legs %}
                  <li>Departs: {{ leg.depart.airport }} {{ leg.depart.dt_formatted }}</li>
                  <li>Arrives: {{ leg.arrive.airport }} {{ leg.arrive.dt_formatted }}</li>
                {% endfor %}
                {% if flight.success %}
                  <span style="color:green"><b>You've been checked into this flight at position {{ flight.position }}</b></span>
                {% else %}
                  {% if flight.sched_time_local_formatted %}
                  <li>
                    <b>Automatically checking you in at:</b> {{ flight.sched_time_local_formatted }}
                  </li>
                  {% endif %}
                {% endif %}
              </ul>
            </li>
          {% endfor %}
        </ul>
      </div>
    </div>
    <div><a href="{{ url_for('delete_reservation', code=res.code) }}" class="btn btn-southwest">Remove automatic check in</a></div>
    {% include 'search_for_checkin_footer.html' %}
  </div>
{% endblock %}